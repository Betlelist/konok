<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>KONOK 43.0 Login Fix</title>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="css/style.css">
</head>
<body>

    <div class="app-container">

        <div id="sidebar-overlay" onclick="App.toggleSidebar()"></div>
        <div id="sidebar">
            <div class="sidebar-header"><div class="logo-text">–ú–ï–ù–Æ</div></div>
            <div class="sidebar-menu">
                <div class="menu-item active" onclick="Router.go('screen-tours'); App.toggleSidebar()">‚úàÔ∏è –†–µ–π—Å—ã</div>
                <div class="menu-item admin-only" onclick="Router.go('screen-locations'); App.toggleSidebar()">üìç –õ–æ–∫–∞—Ü–∏–∏</div>
                <div class="menu-item admin-only" onclick="Router.go('screen-staff'); App.toggleSidebar()">üë• –ö–æ–º–∞–Ω–¥–∞</div>
                <div class="menu-item admin-only" onclick="Router.go('screen-reports'); App.toggleSidebar()">üìä –§–∏–Ω–∞–Ω—Å—ã</div>
                <div class="menu-divider"></div>
                <div class="menu-item logout" onclick="App.logout()">–í—ã—Ö–æ–¥</div>
            </div>
        </div>

        <div id="screen-login" class="screen active center-content">
            <div class="login-wrapper">
                <div class="brand-circle">K</div>
                <h1>KONOK</h1>
                <p class="subtitle">SYSTEM v43</p>
                <div class="wireframe-form">
                    <label>–õ–û–ì–ò–ù</label>
                    <input type="text" id="login-phone" placeholder="admin">
                    <label>–ü–ê–†–û–õ–¨</label>
                    <input type="password" id="login-pass" placeholder="123">
                </div>
                <button class="btn-main" id="btn-login-action" onclick="App.login()">–í–û–ô–¢–ò</button>
                <div class="login-hints">
                    <span>admin: 123</span> | <span>agent: 000</span>
                </div>
            </div>
        </div>

        <div id="screen-dashboard" class="screen">
            <div class="wireframe-header">
                <button class="icon-btn" onclick="App.openNotifications()">üîî<div id="notify-dot" class="dot"></div></button>
                <div class="header-logo">–ì–õ–ê–í–ù–ê–Ø</div>
                <button class="icon-btn" onclick="App.openSearch()">üîç</button>
            </div>
            <div class="user-greeting">
                <span class="text-muted">–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å,</span>
                <h2 id="dash-username-display">Admin</h2>
            </div>
            <div class="widget-today-tomorrow">
                <div class="tt-header">–ë–õ–ò–ñ–ê–ô–®–ò–ï –í–´–ï–ó–î–´</div>
                <div id="widget-tt-content" class="tt-content"></div>
            </div>
            <div class="dashboard-grid">
                <div class="dash-card" onclick="Router.go('screen-tours')"><div class="dc-icon">üöå</div><span class="dc-title">–¢—É—Ä—ã</span></div>
                <div class="dash-card admin-only" onclick="Router.go('screen-locations')"><div class="dc-icon">üìç</div><span class="dc-title">–õ–æ–∫–∞—Ü–∏–∏</span></div>
                <div class="dash-card admin-only" onclick="Router.go('screen-staff')"><div class="dc-icon">üë•</div><span class="dc-title">–ö–æ–º–∞–Ω–¥–∞</span></div>
                <div class="dash-card admin-only" onclick="Router.go('screen-reports')"><div class="dc-icon">üìä</div><span class="dc-title">–§–∏–Ω–∞–Ω—Å—ã</span></div>
                <div class="dash-card" onclick="App.openCalendarModal()"><div class="dc-icon">üìÖ</div><span class="dc-title">–ö–∞–ª–µ–Ω–¥–∞—Ä—å</span></div>
                <div class="dash-card" onclick="Router.go('screen-marketing')"><div class="dc-icon">üöÄ</div><span class="dc-title">–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥</span></div>
            </div>
        </div>

        <div id="screen-tours" class="screen">
            <div class="wireframe-header">
                <button class="icon-btn" onclick="Router.go('screen-dashboard')">‚Üê</button>
                <div class="header-logo">–†–ï–ô–°–´</div>
                <button class="icon-btn admin-only" onclick="App.prepareCreateTour()">+</button>
            </div>
            <div id="tours-list" class="content-list"></div>
        </div>

        <div id="screen-locations" class="screen">
            <div class="wireframe-header">
                <button class="icon-btn" onclick="Router.go('screen-dashboard')">‚Üê</button>
                <div class="header-logo">–õ–û–ö–ê–¶–ò–ò</div>
                <button class="icon-btn" onclick="App.openDestModal()">+</button>
            </div>
            <div id="locations-list-screen" class="content-list"></div>
        </div>

        <div id="screen-staff" class="screen">
            <div class="wireframe-header">
                <button class="icon-btn" onclick="Router.go('screen-dashboard')">‚Üê</button>
                <div class="header-logo">–ö–û–ú–ê–ù–î–ê</div>
                <button class="icon-btn" onclick="App.openEmployeeModal()">+</button>
            </div>
            <div id="staff-list" class="content-list"></div>
        </div>

        <div id="screen-reports" class="screen">
            <div class="wireframe-header"><button class="icon-btn" onclick="Router.go('screen-dashboard')">‚Üê</button><div class="header-logo">–§–ò–ù–ê–ù–°–´</div><div></div></div>
            <div class="scroll-content">
                <div class="finance-block">
                    <div class="fb-header">–û–ë–©–ê–Ø –°–í–û–î–ö–ê</div>
                    <div class="report-row" onclick="View.showReportDetail('net')"><span>–ß–∏—Å—Ç–∞—è –ü—Ä–∏–±—ã–ª—å</span><strong id="rep-net">0 —Å</strong><span class="chevron">‚Ä∫</span></div>
                </div>
                <div class="finance-block">
                    <div class="fb-header">–ü–û –°–ü–û–°–û–ë–ê–ú –û–ü–õ–ê–¢–´</div>
                    <div id="fin-methods-list"></div>
                </div>
                <div class="finance-block">
                    <div class="fb-header">–¢–û–ü –ü–†–ò–ë–´–õ–¨–ù–´–• –¢–£–†–û–í</div>
                    <div id="top-tours-list"></div>
                </div>
                <div class="finance-block">
                    <div class="fb-header">–ö–ê–°–°–ê –ò –î–û–õ–ì–ò</div>
                    <div class="report-row" onclick="View.showReportDetail('guide')"><span>–ù–∞ —Ä—É–∫–∞—Ö —É –≥–∏–¥–æ–≤</span><strong class="text-warn" id="rep-cash-hands">0 —Å</strong> <span class="chevron">‚Ä∫</span></div>
                    <div class="report-row"><span>–í —Å–µ–π—Ñ–µ</span><strong class="text-ok" id="rep-cash-safe">0 —Å</strong></div>
                </div>
            </div>
        </div>

        <div id="screen-details" class="screen">
            <div class="wireframe-header">
                <button class="icon-btn" onclick="Router.go('screen-tours')">‚Üê</button>
                <div class="header-logo">–£–ü–†–ê–í–õ–ï–ù–ò–ï</div>
                <button class="icon-btn admin-only" onclick="App.editCurrentTour()">‚úé</button>
            </div>
            <div class="scroll-content">
                <div class="wireframe-card">
                    <h2 id="detail-title">–ù–∞–∑–≤–∞–Ω–∏–µ</h2>
                    <p id="detail-date" class="text-muted">–î–∞—Ç–∞</p>
                    <div class="breakeven-block admin-only">
                        <div class="be-labels"><span>–û–∫—É–ø–∞–µ–º–æ—Å—Ç—å</span><span id="be-percent">0%</span></div>
                        <div class="be-bar-bg"><div id="be-bar-fill" class="be-bar-fill"></div></div>
                        <div class="be-money"><span id="detail-income">0</span> / <span id="detail-expense">0</span> —Å</div>
                    </div>
                    <button class="btn-main" onclick="App.openBookingModal(null, {status:'free'})">+ –ë–†–û–ù–¨</button>
                </div>
                <div class="section-label">–°–•–ï–ú–ê –°–ê–õ–û–ù–ê</div>
                <div class="bus-container"><div class="bus-grid" id="detail-grid"></div></div>
                <div class="section-label">–°–ü–ò–°–û–ö</div>
                <div id="passenger-list-container" class="pass-list"></div>
                <div class="actions-row">
                    <button class="btn-outline" onclick="App.generateManifest()">–°–ü–ò–°–û–ö</button>
                    <button class="btn-outline" onclick="App.openWaModal()">WHATSAPP</button>
                </div>
            </div>
        </div>

        <div id="screen-add-tour" class="screen">
            <div class="wireframe-header">
                <button class="btn-text" onclick="Router.go('screen-tours')">–û—Ç–º–µ–Ω–∞</button>
                <div class="header-logo">–ù–û–í–´–ô –¢–£–†</div>
                <button class="btn-text" onclick="App.saveTour()">–ì–æ—Ç–æ–≤–æ</button>
            </div>
            <div class="scroll-content">
                <div class="wireframe-form">
                    <label>–ú–ê–†–®–†–£–¢</label>
                    <div id="destinations-wrapper"></div>
                    <button class="btn-link" onclick="App.addDestInput()">+ –¢–æ—á–∫–∞</button>
                    <div class="split-inputs" style="margin-top:10px">
                        <input type="text" id="new-tour-point" placeholder="–¢–æ—á–∫–∞ —Å–±–æ—Ä–∞">
                        <div style="display:flex; align-items:center; gap:5px;"><span style="font-size:10px">–ú–Ω–æ–≥–æ–¥–Ω.</span><label class="switch"><input type="checkbox" id="is-multiday" onchange="App.toggleDuration()"><span class="slider"></span></label></div>
                    </div>
                    <div id="duration-block" style="display:none; margin-top:5px;"><input type="number" id="new-tour-duration" placeholder="–î–Ω–µ–π"></div>

                    <label>–í–†–ï–ú–Ø</label>
                    <div class="split-inputs">
                        <input type="date" id="new-tour-date-picker" class="wireframe-input-date">
                        <select id="new-tour-time-picker"></select>
                    </div>
                    <div class="row-between" style="margin-top:10px"><span>–ü–æ–≤—Ç–æ—Ä—è—Ç—å (30 –¥–Ω–µ–π)</span><label class="switch"><input type="checkbox" id="is-recurring" onchange="App.toggleRecurring()"><span class="slider"></span></label></div>
                    <div id="recurring-days" style="display:none; padding:10px 0;"><div class="week-selector"><div class="day-check" data-day="1" onclick="this.classList.toggle('selected')">–ü–Ω</div><div class="day-check" data-day="2" onclick="this.classList.toggle('selected')">–í—Ç</div><div class="day-check" data-day="3" onclick="this.classList.toggle('selected')">–°—Ä</div><div class="day-check" data-day="4" onclick="this.classList.toggle('selected')">–ß—Ç</div><div class="day-check" data-day="5" onclick="this.classList.toggle('selected')">–ü—Ç</div><div class="day-check" data-day="6" onclick="this.classList.toggle('selected')">–°–±</div><div class="day-check" data-day="0" onclick="this.classList.toggle('selected')">–í—Å</div></div></div>

                    <label>–†–ï–°–£–†–°–´</label>
                    <input type="number" id="new-tour-price" placeholder="–¶–µ–Ω–∞ –±–∏–ª–µ—Ç–∞">
                    <div class="split-inputs"><select id="new-tour-driver" onchange="App.onDriverChange()"></select><input type="number" id="fee-driver" placeholder="–ó–ü"></div>
                    <div class="info-row" style="margin:5px 0; font-size:12px; color:#888;"><span>–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å –∞–≤—Ç–æ: </span><input type="number" id="new-tour-capacity" value="18" style="width:40px; border:none; background:transparent; color:white; font-weight:bold;"></div>
                    <div class="split-inputs"><select id="new-tour-guide"></select><input type="number" id="fee-guide" placeholder="–ó–ü"></div>
                    <input type="number" id="fee-other" placeholder="–†–∞—Å—Ö–æ–¥—ã">
                </div>
                <button class="btn-main" onclick="App.saveTour()" style="margin-bottom:20px;">–ì–û–¢–û–í–û</button>
            </div>
        </div>

        <div id="modal-booking" class="modal closable-modal">
            <div class="modal-content">
                <h3>–ë–†–û–ù–¨</h3>
                <div class="wireframe-form">
                    <label>–¢–ï–õ–ï–§–û–ù</label>
                    <input type="tel" id="book-phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω" onblur="App.checkClient()">
                    <label>–ò–ú–Ø</label>
                    <input type="text" id="book-name" placeholder="–ò–º—è">
                    <label>–°–ü–û–°–û–ë –û–ü–õ–ê–¢–´</label>
                    <select id="book-method">
                        <option value="mbank">Mbank</option>
                        <option value="optima">Optima</option>
                        <option value="obank">O!Bank</option>
                        <option value="cash">–ù–∞–ª–∏—á–Ω—ã–µ</option>
                    </select>
                </div>
                <div class="segment-control"><button class="seg-btn active" id="st-pending" onclick="App.setPayStatus('pending')">üü° –ñ–¥–µ—Ç</button><button class="seg-btn" id="st-partial" onclick="App.setPayStatus('partial')">üü† 50%</button><button class="seg-btn" id="st-taken" onclick="App.setPayStatus('taken')">üü¢ –û–ø–ª.</button></div>
                <div class="counter-row"><button onclick="App.changeSeatCount(-1)">-</button><span id="book-count">1</span><button onclick="App.changeSeatCount(1)">+</button></div>
                <button class="btn-main" onclick="App.saveBooking()">–°–û–•–†–ê–ù–ò–¢–¨</button>
                <button class="btn-danger" id="btn-cancel-booking" onclick="App.cancelBooking()">–£–î–ê–õ–ò–¢–¨</button>
                <button class="btn-close" onclick="App.closeModal('modal-booking')">–ó–ê–ö–†–´–¢–¨</button>
            </div>
        </div>
        
        <div id="modal-destinations" class="modal closable-modal"><div class="modal-content"><h3>–õ–û–ö–ê–¶–ò–Ø</h3><div class="wireframe-form"><label>–ù–ê–ó–í–ê–ù–ò–ï</label><input type="text" id="new-dest-name" placeholder="–ù–∞–∑–≤–∞–Ω–∏–µ"><label>–û–ü–ò–°–ê–ù–ò–ï</label><input type="text" id="new-dest-desc" placeholder="–û–ø–∏—Å–∞–Ω–∏–µ"></div><button class="btn-main" onclick="App.addDestinationToDb()">–°–û–•–†–ê–ù–ò–¢–¨</button><button class="btn-close" onclick="App.closeModal('modal-destinations')">–ó–ê–ö–†–´–¢–¨</button></div></div>
        
        <div id="modal-employee" class="modal closable-modal"><div class="modal-content"><h3>–°–û–¢–†–£–î–ù–ò–ö</h3><div class="wireframe-form"><label>–ò–ú–Ø</label><input type="text" id="emp-name" placeholder="–ò–º—è"><label>–¢–ï–õ–ï–§–û–ù</label><input type="tel" id="emp-phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω"><label>–†–û–õ–¨</label><select id="emp-role" onchange="App.toggleCapacityField()"><option value="driver">–í–æ–¥–∏—Ç–µ–ª—å</option><option value="guide">–ì–∏–¥</option><option value="agent">–ê–≥–µ–Ω—Ç</option></select><div id="emp-extra-fields"><label>–í–ú–ï–°–¢–ò–ú–û–°–¢–¨ / %</label><input type="number" id="emp-capacity" placeholder="–ú–µ—Å—Ç (18)" value="18"><input type="number" id="emp-commission" placeholder="–ö–æ–º–∏—Å—Å–∏—è %" style="display:none"></div></div><button class="btn-main" onclick="App.saveEmployee()">–°–û–•–†–ê–ù–ò–¢–¨</button><button class="btn-close" onclick="App.closeModal('modal-employee')">–ó–ê–ö–†–´–¢–¨</button></div></div>
        
        <div id="modal-calendar" class="modal bottom-sheet closable-modal"><div class="modal-content"><div class="cal-header"><button onclick="View.changeMonth(-1)">‚Äπ</button><span id="cal-month-year-modal">–ú–ê–ô</span><button onclick="View.changeMonth(1)">‚Ä∫</button></div><div class="cal-weekdays"><span>–ü–ù</span><span>–í–¢</span><span>–°–†</span><span>–ß–¢</span><span>–ü–¢</span><span>–°–ë</span><span>–í–°</span></div><div class="cal-grid" id="calendar-widget-modal"></div><button class="btn-close" onclick="App.closeModal('modal-calendar')">–ó–ê–ö–†–´–¢–¨</button></div></div>
        <div id="modal-day-details" class="modal bottom-sheet closable-modal"><div class="modal-content"><h3>–†–ï–ô–°–´</h3><div id="day-tours-list" class="simple-list"></div><button class="btn-main admin-only" id="btn-create-on-date" style="margin-top:10px">–°–û–ó–î–ê–¢–¨ –¢–£–†</button><button class="btn-close" onclick="App.closeModal('modal-day-details')">–ó–ê–ö–†–´–¢–¨</button></div></div>
        <div id="modal-deposit" class="modal closable-modal"><div class="modal-content"><h3>–°–î–ê–ß–ê</h3><p id="deposit-guide-name">–ì–∏–¥</p><div class="wireframe-form"><input type="number" id="deposit-amount" placeholder="–°—É–º–º–∞"></div><button class="btn-main" onclick="App.makeDeposit()">–ü–†–ò–ù–Ø–¢–¨</button><button class="btn-close" onclick="App.closeModal('modal-deposit')">–û–¢–ú–ï–ù–ê</button></div></div>
        <div id="modal-report-detail" class="modal closable-modal"><div class="modal-content"><h3>–î–ï–¢–ê–õ–ò</h3><div id="report-detail-list" class="simple-list"></div><button class="btn-close" onclick="App.closeModal('modal-report-detail')">–ó–ê–ö–†–´–¢–¨</button></div></div>
        <div id="modal-whatsapp" class="modal bottom-sheet closable-modal"><div class="modal-content"><h3>WHATSAPP</h3><textarea id="wa-text-area" rows="6" class="wireframe-input"></textarea><button class="btn-main" onclick="App.copyWaText()">–ö–û–ü–ò–†–û–í–ê–¢–¨</button><button class="btn-close" onclick="App.closeModal('modal-whatsapp')">–ó–ê–ö–†–´–¢–¨</button></div></div>
        <div id="modal-search" class="modal closable-modal"><div class="modal-content full-height"><div class="sheet-header"><input type="text" id="search-input" class="search-bar" placeholder="–ü–æ–∏—Å–∫..." onkeyup="View.performSearch()"><button class="btn-text" onclick="App.closeModal('modal-search')">–ó–∞–∫—Ä—ã—Ç—å</button></div><div id="search-results" class="clean-list"></div></div></div>
        <div id="modal-notifications" class="modal bottom-sheet closable-modal"><div class="modal-content"><h3>–£–í–ï–î–û–ú–õ–ï–ù–ò–Ø</h3><div id="notify-list"></div><button class="btn-close" onclick="App.closeModal('modal-notifications')">–ó–ê–ö–†–´–¢–¨</button></div></div>
        <div id="modal-story" class="modal closable-modal"><div class="modal-content" style="background:#111; color:white; border:1px solid #333"><div class="story-card"><div class="story-date" id="story-date">–ó–ê–í–¢–†–ê</div><h2 id="story-title">–¢—É—Ä</h2><div class="story-price" id="story-price">0</div><div class="story-seats" id="story-seats">–ú–µ—Å—Ç–∞ –µ—Å—Ç—å!</div></div><button class="btn-close" onclick="App.closeModal('modal-story')" style="color:white; border-color:white;">–ó–ê–ö–†–´–¢–¨</button></div></div>
        <div id="screen-marketing" class="screen center-content"><div class="wireframe-header absolute-top"><button class="icon-btn" onclick="Router.go('screen-dashboard')">‚Üê</button><div class="header-logo">–ú–ê–†–ö–ï–¢–ò–ù–ì</div><div></div></div><div class="empty-state"><h3>–°–ö–û–†–û</h3><p>–í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ</p></div></div>

    </div>

    <script src="js/db.js"></script>
    <script src="js/view.js"></script>
    <script src="js/controller.js"></script>
</body>
</html>